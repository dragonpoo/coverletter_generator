!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(O){"use strict";var Z,p;O.fn.fileinputLocales={},O.fn.fileinputThemes={},String.prototype.setTokens=function(e){var i,t,a=this.toString();for(i in e)e.hasOwnProperty(i)&&(t=new RegExp("{"+i+"}","g"),a=a.replace(t,e[i]));return a},Z={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",STYLE_SETTING:'style="width:{width};height:{height};"',OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,compare:function(e,i,t){return void 0!==e&&(t?e===i:e.match(i))},isIE:function(e){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===e)return new RegExp("msie\\s"+e,"i").test(navigator.userAgent);var i,t=document.createElement("div");return t.innerHTML="\x3c!--[if IE "+e+"]> <i></i> <![endif]--\x3e",i=t.getElementsByTagName("i").length,document.body.appendChild(t),t.parentNode.removeChild(t),i},initModal:function(e){var i=O("body");i.length&&e.appendTo(i)},isEmpty:function(e,i){return null==e||0===e.length||i&&""===O.trim(e)},isArray:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},ifSet:function(e,i,t){return t=t||"",i&&"object"==typeof i&&e in i?i[e]:t},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter(function(e){return null!=e})},spliceArray:function(e,i){var t,a=0,n=[];if(!(e instanceof Array))return[];for(t=0;t<e.length;t++)t!==i&&(n[a]=e[t],a++);return n},getNum:function(e,i){return i=i||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?i:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=document.createElement("div");return!Z.isIE(9)&&(void 0!==e.draggable||void 0!==e.ondragstart&&void 0!==e.ondrop)},hasFileUploadSupport:function(){return Z.hasFileAPISupport()&&window.FormData},addCss:function(e,i){e.removeClass(i).addClass(i)},getElement:function(e,i,t){return Z.isEmpty(e)||Z.isEmpty(e[i])?t:O(e[i])},uniqId:function(){return Math.round((new Date).getTime()+100*Math.random())},htmlEncode:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(e,i){var t=e;return i&&O.each(i,function(e,i){"function"==typeof i&&(i=i()),t=t.split(e).join(i)}),t},cleanMemory:function(e){var i=e.is("img")?e.attr("src"):e.find("source").attr("src");Z.objUrl.revokeObjectURL(i)},findFileName:function(e){var i=e.lastIndexOf("/");return-1===i&&(i=e.lastIndexOf("\\")),e.split(e.substring(i,i+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var i=document,t=i.documentElement;t&&e&&!Z.checkFullScreen()?t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()},moveArray:function(e,i,t){if(t>=e.length)for(var a=t-e.length;1+a--;)e.push(void 0);return e.splice(t,0,e.splice(i,1)[0]),e},cleanZoomCache:function(e){var i=e.closest(".kv-zoom-cache-theme");i.length||(i=e.closest(".kv-zoom-cache")),i.remove()},setOrientation:function(e,i){var t,a,n=new DataView(e),r=0,o=1;if(!(65496!==n.getUint16(r)||e.length<2)){for(r+=2,t=n.byteLength;r<t-2;)switch(a=n.getUint16(r),r+=2,a){case 65505:t=n.getUint16(r)-r,r+=2;break;case 274:o=n.getUint16(r+6,!1),t=0}i&&i(o)}},validateOrientation:function(e,i){if(window.FileReader&&window.DataView){var t,a=new FileReader;a.onloadend=function(){t=a.result,Z.setOrientation(t,i)},a.readAsArrayBuffer(e)}},adjustOrientedImage:function(e,i){var t;e.hasClass("is-portrait-gt4")&&(i?e.css({width:e.parent().height()}):(e.css({height:"auto",width:e.height()}),t=e.parent().offset().top-e.offset().top,e.css("margin-top",t)))}},(p=function(e,i){var t=this;t.$element=O(e),t._validate()&&(t.isPreviewable=Z.hasFileAPISupport(),t.isIE9=Z.isIE(9),t.isIE10=Z.isIE(10),t.isPreviewable||t.isIE9?(t._init(i),t._listen()):t.$element.removeClass("file-loading"))}).prototype={constructor:p,_cleanup:function(){var e=this;e.reader=null,e.formdata={},e.uploadCount=0,e.uploadStatus={},e.uploadLog=[],e.uploadAsyncCount=0,e.loadedImages=[],e.totalImagesCount=0,e.ajaxRequests=[],e.clearStack(),e.fileInputCleared=!1,e.fileBatchCompleted=!0,e.isPreviewable||(e.showPreview=!1),e.isError=!1,e.ajaxAborted=!1,e.cancelling=!1},_init:function(e){var i,t,a=this,n=a.$element;a.options=e,O.each(e,function(e,i){switch(e){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":a[e]=Z.getNum(i);break;default:a[e]=i}}),a._cleanup(),a.$form=n.closest("form"),a._initTemplateDefaults(),a.uploadFileAttr=Z.isEmpty(n.attr("name"))?"file_data":n.attr("name"),t=a._getLayoutTemplate("progress"),a.progressTemplate=t.replace("{class}",a.progressClass),a.progressCompleteTemplate=t.replace("{class}",a.progressCompleteClass),a.progressErrorTemplate=t.replace("{class}",a.progressErrorClass),a.dropZoneEnabled=Z.hasDragDropSupport()&&a.dropZoneEnabled,a.isDisabled=n.attr("disabled")||n.attr("readonly"),a.isDisabled&&n.attr("disabled",!0),a.isUploadable=Z.hasFileUploadSupport()&&!Z.isEmpty(a.uploadUrl),a.isClickable=a.browseOnZoneClick&&a.showPreview&&(a.isUploadable&&a.dropZoneEnabled||!Z.isEmpty(a.defaultPreviewContent)),a.slug="function"==typeof e.slugCallback?e.slugCallback:a._slugDefault,a.mainTemplate=a.showCaption?a._getLayoutTemplate("main1"):a._getLayoutTemplate("main2"),a.captionTemplate=a._getLayoutTemplate("caption"),a.previewGenericTemplate=a._getPreviewTemplate("generic"),a.resizeImage&&(a.maxImageWidth||a.maxImageHeight)&&(a.imageCanvas=document.createElement("canvas"),a.imageCanvasContext=a.imageCanvas.getContext("2d")),Z.isEmpty(n.attr("id"))&&n.attr("id",Z.uniqId()),a.namespace=".fileinput_"+n.attr("id").replace(/-/g,"_"),void 0===a.$container?a.$container=a._createContainer():a._refreshContainer(),i=a.$container,a.$dropZone=i.find(".file-drop-zone"),a.$progress=i.find(".kv-upload-progress"),a.$btnUpload=i.find(".fileinput-upload"),a.$captionContainer=Z.getElement(e,"elCaptionContainer",i.find(".file-caption")),a.$caption=Z.getElement(e,"elCaptionText",i.find(".file-caption-name")),a.$previewContainer=Z.getElement(e,"elPreviewContainer",i.find(".file-preview")),a.$preview=Z.getElement(e,"elPreviewImage",i.find(".file-preview-thumbnails")),a.$previewStatus=Z.getElement(e,"elPreviewStatus",i.find(".file-preview-status")),a.$errorContainer=Z.getElement(e,"elErrorContainer",a.$previewContainer.find(".kv-fileinput-error")),Z.isEmpty(a.msgErrorClass)||Z.addCss(a.$errorContainer,a.msgErrorClass),a.$errorContainer.hide(),a.previewInitId="preview-"+Z.uniqId(),a._initPreviewCache(),a._initPreview(!0),a._initPreviewActions(),a._setFileDropZoneTitle(),n.removeClass("file-loading"),n.attr("disabled")&&a.disable(),a._initZoom()},_initTemplateDefaults:function(){var e,i,t,a,n,r,o,l,s,d,c,p=this;e='<div id="'+Z.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+Z.MODAL_ID+'Label"></div>',i='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"',t='<div class="kv-preview-data file-preview-html" title="{caption}" '+Z.STYLE_SETTING+">{data}</div>\n",a='<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" '+Z.STYLE_SETTING+">\n",n='<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly '+Z.STYLE_SETTING+">{data}</textarea>\n",r='<video class="kv-preview-data file-preview-video" width="{width}" height="{height}" controls>\n<source src="{data}" type="{type}">\n'+Z.DEFAULT_PREVIEW+"\n</video>\n",o='<div class="file-preview-audio"><audio class="kv-preview-data" controls>\n<source src="{data}" type="{type}">\n'+Z.DEFAULT_PREVIEW+"\n</audio></div>\n",l='<object class="kv-preview-data file-object" type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+Z.OBJECT_PARAMS+" "+Z.DEFAULT_PREVIEW+"\n</object>\n",s='<object class="kv-preview-data file-object {typeCss}" data="{data}" type="{type}" width="{width}" height="{height}">\n<param name="movie" value="{caption}" />\n'+Z.OBJECT_PARAMS+" "+Z.DEFAULT_PREVIEW+"\n</object>\n",d='<div class="kv-preview-data file-preview-other-frame">\n'+Z.DEFAULT_PREVIEW+"\n</div>\n",c={width:"100%",height:"100%","min-height":"480px"},p.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:'<div class="close fileinput-remove">&times;</div>\n',fileIcon:'<i class="glyphicon glyphicon-file kv-caption-icon"></i>',caption:'<div tabindex="500" class="form-control file-caption {class}">\n   <div class="file-caption-name"></div>\n</div>\n',modalMain:e,modal:'<div class="modal-dialog modal-lg" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="kv-zoom-actions pull-right">{toggleheader}{fullscreen}{borderless}{close}</div>\n      <h3 class="modal-title">{heading} <small><span class="kv-zoom-title"></span></small></h3>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">{caption}<br>{size}</div>\n    {progress} {indicator} {actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:'{drag}\n<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload} {delete} {zoom} {other}    </div>\n    <div class="clearfix"></div>\n</div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"><div class="kv-file-content">\n',tagBefore2:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}" title="{caption}"><div class="kv-file-content">\n',tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:t,image:a,text:n,video:r,audio:o,flash:l,object:s,pdf:'<embed class="kv-preview-data" src="{data}" width="{width}" height="{height}" type="application/pdf">\n',other:d},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"100%","max-width":"100%"},object:{height:"100%"},pdf:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:c,text:c,video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:c,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(e,i){return Z.compare(e,"image.*")||Z.compare(i,/\.(gif|png|jpe?g)$/i)},html:function(e,i){return Z.compare(e,"text/html")||Z.compare(i,/\.(htm|html)$/i)},text:function(e,i){return Z.compare(e,"text.*")||Z.compare(i,/\.(xml|javascript)$/i)||Z.compare(i,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(e,i){return Z.compare(e,"video.*")&&(Z.compare(e,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||Z.compare(i,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(e,i){return Z.compare(e,"audio.*")&&(Z.compare(i,/(ogg|mp3|mp?g|wav)$/i)||Z.compare(i,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(e,i){return Z.compare(e,"application/x-shockwave-flash",!0)||Z.compare(i,/\.(swf)$/i)},pdf:function(e,i){return Z.compare(e,"application/pdf",!0)||Z.compare(i,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-xs btn-default",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-menu-hamburger"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},O.each(p.defaults,function(e,i){"allowedPreviewTypes"!==e?p[e]=O.extend(!0,{},i,p[e]):void 0===p.allowedPreviewTypes&&(p.allowedPreviewTypes=i)}),p._initPreviewTemplates()},_initPreviewTemplates:function(){var t,a=this,e=a.defaults,n=a.previewMarkupTags,r=n.tagAfter;O.each(e.previewContentTemplates,function(e,i){Z.isEmpty(a.previewTemplates[e])&&(t=n.tagBefore2,"generic"!==e&&"image"!==e&&"html"!==e&&"text"!==e||(t=n.tagBefore1),a.previewTemplates[e]=t+i+r)})},_initPreviewCache:function(){var v=this;v.previewCache={data:{},init:function(){var e=v.initialPreview;0<e.length&&!Z.isArray(e)&&(e=e.split(v.initialPreviewDelimiter)),v.previewCache.data={content:e,config:v.initialPreviewConfig,tags:v.initialPreviewThumbTags}},fetch:function(){return v.previewCache.data.content.filter(function(e){return null!==e})},count:function(e){return v.previewCache.data&&v.previewCache.data.content?e?v.previewCache.data.content.length:v.previewCache.fetch().length:0},get:function(e,i){var t,a,n,r,o,l,s,d="init_"+e,c=v.previewCache.data,p=c.config[e],u=c.content[e],f=v.previewInitId+"-"+d,m=Z.ifSet("previewAsData",p,v.initialPreviewAsData),h=function(e,i,t,a,n,r,o,l,s){return l=" file-preview-initial "+Z.SORT_CSS+(l?" "+l:""),v._generatePreviewTemplate(e,i,t,a,n,!1,null,l,r,o,s)};return u?(i=void 0===i||i,n=Z.ifSet("type",p,v.initialPreviewFileType||"generic"),o=Z.ifSet("filename",p,Z.ifSet("caption",p)),l=Z.ifSet("filetype",p,n),r=v.previewCache.footer(e,i,p&&p.size||null),s=Z.ifSet("frameClass",p),t=m?h(n,u,o,l,f,r,d,s):h("generic",u,o,l,f,r,d,s,n).setTokens({content:c.content[e]}),c.tags.length&&c.tags[e]&&(t=Z.replaceTags(t,c.tags[e])),Z.isEmpty(p)||Z.isEmpty(p.frameAttr)||((a=O(document.createElement("div")).html(t)).find(".file-preview-initial").attr(p.frameAttr),t=a.html(),a.remove()),t):""},add:function(e,i,t,a){var n,r=v.previewCache.data;return Z.isArray(e)||(e=e.split(v.initialPreviewDelimiter)),a?(n=r.content.push(e)-1,r.config[n]=i,r.tags[n]=t):(n=e.length-1,r.content=e,r.config=i,r.tags=t),v.previewCache.data=r,n},set:function(e,i,t,a){var n,r=v.previewCache.data;if(e&&e.length&&(Z.isArray(e)||(e=e.split(v.initialPreviewDelimiter)),e.filter(function(e){return null!==e}).length)){if(void 0===r.content&&(r.content=[]),void 0===r.config&&(r.config=[]),void 0===r.tags&&(r.tags=[]),a){for(n=0;n<e.length;n++)e[n]&&r.content.push(e[n]);for(n=0;n<i.length;n++)i[n]&&r.config.push(i[n]);for(n=0;n<t.length;n++)t[n]&&r.tags.push(t[n])}else r.content=e,r.config=i,r.tags=t;v.previewCache.data=r}},unset:function(e){var i=v.previewCache.count();if(i){if(1===i)return v.previewCache.data.content=[],v.previewCache.data.config=[],v.previewCache.data.tags=[],v.initialPreview=[],v.initialPreviewConfig=[],void(v.initialPreviewThumbTags=[]);v.previewCache.data.content[e]=null,v.previewCache.data.config[e]=null,v.previewCache.data.tags[e]=null}},out:function(){var e,i="",t=v.previewCache.count(!0);if(0===t)return{content:"",caption:""};for(e=0;e<t;e++)i+=v.previewCache.get(e);return{content:i,caption:v._getMsgSelected(v.previewCache.count())}},footer:function(e,i,t){var a=v.previewCache.data;if(!a||!a.config||0===a.config.length||Z.isEmpty(a.config[e]))return"";i=void 0===i||i;var n,r=a.config[e],o=Z.ifSet("caption",r),l=Z.ifSet("width",r,"auto"),s=Z.ifSet("url",r,!1),d=Z.ifSet("key",r,null),c=v.fileActionSettings,p=v.initialPreviewShowDelete||!1,u=Z.ifSet("showDelete",r,Z.ifSet("showDelete",c,p)),f=Z.ifSet("showZoom",r,Z.ifSet("showZoom",c,!0)),m=Z.ifSet("showDrag",r,Z.ifSet("showDrag",c,!0)),h=!1===s&&i;return n=v._renderFileActions(!1,u,f,m,h,s,d,!0),v._getLayoutTemplate("footer").setTokens({progress:v._renderThumbProgress(),actions:n,caption:o,size:v._getSize(t),width:l,indicator:""})}},v.previewCache.init()},_handler:function(e,i,t){var a=this.namespace,n=i.split(" ").join(a+" ")+a;e&&e.length&&e.off(n).on(n,t)},_log:function(e){var i=this.$element.attr("id");i&&(e='"'+i+'": '+e),void 0!==window.console.log?window.console.log(e):window.alert(e)},_validate:function(){var e="file"===this.$element.attr("type");return e||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.'),e},_errorsExist:function(){var e;return!!this.$errorContainer.find("li").length||((e=O(document.createElement("div")).html(this.$errorContainer.html())).find("span.kv-error-close").remove(),e.find("ul").remove(),!!O.trim(e.text()).length)},_errorHandler:function(e,i){var t=this,a=e.target.error,n=function(e){t._showError(e.replace("{name}",i))};a.code===a.NOT_FOUND_ERR?n(t.msgFileNotFound):a.code===a.SECURITY_ERR?n(t.msgFileSecured):a.code===a.NOT_READABLE_ERR?n(t.msgFileNotReadable):a.code===a.ABORT_ERR?n(t.msgFilePreviewAborted):n(t.msgFilePreviewError)},_addError:function(e){var i=this.$errorContainer;e&&i.length&&(i.html(this.errorCloseButton+e),this._handler(i.find(".kv-error-close"),"click",function(){i.fadeOut("slow")}))},_resetErrors:function(e){var i=this.$errorContainer;this.isError=!1,this.$container.removeClass("has-error"),i.html(""),e?i.fadeOut("slow"):i.hide()},_showFolderError:function(e){var i,t=this,a=t.$errorContainer;e&&(i=t.msgFoldersNotAllowed.replace("{n}",e),t._addError(i),Z.addCss(t.$container,"has-error"),a.fadeIn(800),t._raise("filefoldererror",[e,i]))},_showUploadError:function(e,i,t){var a=this,n=a.$errorContainer,r=t||"fileuploaderror",o=i&&i.id?'<li data-file-id="'+i.id+'">'+e+"</li>":"<li>"+e+"</li>";return 0===n.find("ul").length?a._addError("<ul>"+o+"</ul>"):n.find("ul").append(o),n.fadeIn(800),a._raise(r,[i,e]),a.$container.removeClass("file-input-new"),Z.addCss(a.$container,"has-error"),!0},_showError:function(e,i,t){var a=this,n=a.$errorContainer,r=t||"fileerror";return(i=i||{}).reader=a.reader,a._addError(e),n.fadeIn(800),a._raise(r,[i,e]),a.isUploadable||a._clearFileInput(),a.$container.removeClass("file-input-new"),Z.addCss(a.$container,"has-error"),a.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var i=this,t=1<i.minFileCount?i.filePlural:i.fileSingle,a=i.msgFilesTooLess.replace("{n}",i.minFileCount).replace("{files}",t),n=i.$errorContainer;i._addError(a),i.isError=!0,i._updateFileDetails(0),n.fadeIn(800),i._raise("fileerror",[e,a]),i._clearFileInput(),Z.addCss(i.$container,"has-error")},_parseError:function(e,i,t,a){var n=this,r=O.trim(t+""),o="."===r.slice(-1)?"":".",l=void 0!==i.responseJSON&&void 0!==i.responseJSON.error?i.responseJSON.error:i.responseText;return n.cancelling&&n.msgUploadAborted&&(r=n.msgUploadAborted),n.showAjaxErrorDetails&&l?r+=o+(l=0<(l=O.trim(l.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+l+"</pre>":""):r+=o,r===o&&(r=n.msgAjaxError.replace("{operation}",e)),n.cancelling=!1,a?"<b>"+a+": </b>"+r:r},_parseFileType:function(e){var i,t,a,n=this.allowedPreviewTypes||[];for(a=0;a<n.length;a++)if(t=n[a],i=(0,this.fileTypeSettings[t])(e.type,e.name)?t:"",!Z.isEmpty(i))return i;return"other"},_getPreviewIcon:function(e){var t,a=this,n=null;return e&&-1<e.indexOf(".")&&(t=e.split(".").pop(),a.previewFileIconSettings&&(n=a.previewFileIconSettings[t]||a.previewFileIconSettings[t.toLowerCase()]||null),a.previewFileExtSettings&&O.each(a.previewFileExtSettings,function(e,i){a.previewFileIconSettings[e]&&i(t)&&(n=a.previewFileIconSettings[e])})),n},_parseFilePreviewIcon:function(e,i){var t=this._getPreviewIcon(i)||this.previewFileIcon,a=e;return-1<a.indexOf("{previewFileIcon}")&&(a=a.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:t})),a},_raise:function(e,i){var t=O.Event(e);if(void 0!==i?this.$element.trigger(t,i):this.$element.trigger(t),t.isDefaultPrevented()||!1===t.result)return!1;switch(e){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=t.result)}return!0},_listenFullScreen:function(e){var i,t,a=this.$modal;a&&a.length&&(i=a&&a.find(".btn-fullscreen"),t=a&&a.find(".btn-borderless"),i.length&&t.length&&(i.removeClass("active").attr("aria-pressed","false"),t.removeClass("active").attr("aria-pressed","false"),e?i.addClass("active").attr("aria-pressed","true"):t.addClass("active").attr("aria-pressed","true"),a.hasClass("file-zoom-fullscreen")?this._maximizeZoomDialog():e?this._maximizeZoomDialog():t.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var e=this,i=e.$element,t=e.$form,a=e.$container;e._handler(i,"change",O.proxy(e._change,e)),e.showBrowse&&e._handler(e.$btnFile,"click",O.proxy(e._browse,e)),e._handler(a.find(".fileinput-remove:not([disabled])"),"click",O.proxy(e.clear,e)),e._handler(a.find(".fileinput-cancel"),"click",O.proxy(e.cancel,e)),e._initDragDrop(),e._handler(t,"reset",O.proxy(e.reset,e)),e.isUploadable||e._handler(t,"submit",O.proxy(e._submitForm,e)),e._handler(e.$container.find(".fileinput-upload"),"click",O.proxy(e._uploadClick,e)),e._handler(O(window),"resize",function(){e._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),e._handler(O(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){e._listenFullScreen(Z.checkFullScreen())}),e._initClickable()},_initClickable:function(){var t,a=this;a.isClickable&&(t=a.isUploadable?a.$dropZone:a.$preview.find(".file-default-preview"),Z.addCss(t,"clickable"),t.attr("tabindex",-1),a._handler(t,"click",function(e){var i=O(e.target);i.parents(".file-preview-thumbnails").length&&!i.parents(".file-default-preview").length||(a.$element.trigger("click"),t.blur())}))},_initDragDrop:function(){var e=this,i=e.$dropZone;e.isUploadable&&e.dropZoneEnabled&&e.showPreview&&(e._handler(i,"dragenter dragover",O.proxy(e._zoneDragEnter,e)),e._handler(i,"dragleave",O.proxy(e._zoneDragLeave,e)),e._handler(i,"drop",O.proxy(e._zoneDrop,e)),e._handler(O(document),"dragenter dragover drop",e._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(e){var i=-1<O.inArray("Files",e.originalEvent.dataTransfer.types);if(this._zoneDragDropInit(e),this.isDisabled||!i)return e.originalEvent.dataTransfer.effectAllowed="none",void(e.originalEvent.dataTransfer.dropEffect="none");Z.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){e.preventDefault(),this.isDisabled||Z.isEmpty(e.originalEvent.dataTransfer.files)||(this._change(e,"dragdrop"),this.$dropZone.removeClass("file-highlighted"))},_uploadClick:function(e){var i,t=this.$container.find(".fileinput-upload"),a=!t.hasClass("disabled")&&Z.isEmpty(t.attr("disabled"));e&&e.isDefaultPrevented()||(this.isUploadable?(e.preventDefault(),a&&this.upload()):a&&"submit"!==t.attr("type")&&((i=t.closest("form")).length&&i.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var e=this,i=e.$preview;(e.showUploadedThumbs?i.find(Z.FRAMES+":not(.file-preview-success)"):i.find(Z.FRAMES)).each(function(){var e=O(this);e.remove(),Z.cleanZoomCache(i.find("#zoom-"+e.attr("id")))}),e.$preview.find(Z.FRAMES).length&&e.showPreview||e._resetUpload(),e._validateDefaultPreview()},_initSortable:function(){var e,r=this,i=r.$preview,t="."+Z.SORT_CSS;window.KvSortable&&0!==i.find(t).length&&(e={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:t,onSort:function(e){var i,t=e.oldIndex,a=e.newIndex;r.initialPreview=Z.moveArray(r.initialPreview,t,a),r.initialPreviewConfig=Z.moveArray(r.initialPreviewConfig,t,a),r.previewCache.init();for(var n=0;n<r.initialPreviewConfig.length;n++)null!==r.initialPreviewConfig[n]&&(i=r.initialPreviewConfig[n].key,O(".kv-file-remove[data-key='"+i+"']").closest(Z.FRAMES).attr("data-fileindex","init_"+n).attr("data-fileindex","init_"+n));r._raise("filesorted",{previewId:O(e.item).attr("id"),oldIndex:t,newIndex:a,stack:r.initialPreviewConfig})}},i.data("kvsortable")&&i.kvsortable("destroy"),O.extend(!0,e,r.fileActionSettings.dragSettings),i.kvsortable(e))},_initPreview:function(e){var i,t=this,a=t.initialCaption||"";if(!t.previewCache.count())return t._clearPreview(),void(e?t._setCaption(a):t._initCaption());i=t.previewCache.out(),a=e&&t.initialCaption?t.initialCaption:i.caption,t.$preview.html(i.content),t._setInitThumbAttr(),t._setCaption(a),t._initSortable(),Z.isEmpty(i.content)||t.$container.removeClass("file-input-new")},_getZoomButton:function(e){var i=this.previewZoomButtonIcons[e],t=this.previewZoomButtonClasses[e],a=' title="'+(this.previewZoomButtonTitles[e]||"")+'" '+("close"===e?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==e&&"borderless"!==e&&"toggleheader"!==e||(a+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+t+" btn-"+e+'"'+a+">"+i+"</button>"},_getModalContent:function(){var e=this;return e._getLayoutTemplate("modal").setTokens({zoomFrameClass:e.frameClass,heading:e.msgZoomModalHeading,prev:e._getZoomButton("prev"),next:e._getZoomButton("next"),toggleheader:e._getZoomButton("toggleheader"),fullscreen:e._getZoomButton("fullscreen"),borderless:e._getZoomButton("borderless"),close:e._getZoomButton("close")})},_listenModalEvent:function(a){var n=this,r=n.$modal;r.on(a+".bs.modal",function(e){var i=r.find(".btn-fullscreen"),t=r.find(".btn-borderless");n._raise("filezoom"+a,{sourceEvent:e,previewId:r.data("previewId"),modal:r}),"shown"===a&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),r.hasClass("file-zoom-fullscreen")&&(n._maximizeZoomDialog(),Z.checkFullScreen()?i.addClass("active").attr("aria-pressed","true"):t.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var e,t=this,i=t._getLayoutTemplate("modalMain"),a="#"+Z.MODAL_ID;t.showPreview&&(t.$modal=O(a),t.$modal&&t.$modal.length||(e=O(document.createElement("div")).html(i).insertAfter(t.$container),t.$modal=O(a).insertBefore(e),e.remove()),Z.initModal(t.$modal),t.$modal.html(t._getModalContent()),O.each(Z.MODAL_EVENTS,function(e,i){t._listenModalEvent(i)}))},_initZoomButtons:function(){var e,i,t=this.$modal.data("previewId")||"",a=this.$preview.find(Z.FRAMES).toArray(),n=a.length,r=this.$modal.find(".btn-prev"),o=this.$modal.find(".btn-next");if(a.length<2)return r.hide(),void o.hide();r.show(),o.show(),n&&(e=O(a[0]),i=O(a[n-1]),r.removeAttr("disabled"),o.removeAttr("disabled"),e.length&&e.attr("id")===t&&r.attr("disabled",!0),i.length&&i.attr("id")===t&&o.attr("disabled",!0))},_maximizeZoomDialog:function(){var e=this.$modal,i=e.find(".modal-header:visible"),t=e.find(".modal-footer:visible"),a=e.find(".modal-body"),n=O(window).height();e.addClass("file-zoom-fullscreen"),i&&i.length&&(n-=i.outerHeight(!0)),t&&t.length&&(n-=t.outerHeight(!0)),a&&a.length&&(n-=a.outerHeight(!0)-a.height()),e.find(".kv-zoom-body").height(n)},_resizeZoomDialog:function(e){var i=this,t=i.$modal,a=t.find(".btn-fullscreen"),n=t.find(".btn-borderless");if(t.hasClass("file-zoom-fullscreen"))Z.toggleFullScreen(!1),e?a.hasClass("active")||(t.removeClass("file-zoom-fullscreen"),i._resizeZoomDialog(!0),n.hasClass("active")&&n.removeClass("active").attr("aria-pressed","false")):a.hasClass("active")?a.removeClass("active").attr("aria-pressed","false"):(t.removeClass("file-zoom-fullscreen"),i.$modal.find(".kv-zoom-body").css("height",i.zoomModalHeight));else{if(!e)return void i._maximizeZoomDialog();Z.toggleFullScreen(!0)}t.focus()},_setZoomContent:function(e,i){var t,a,n,r,o,l,s,d,c=this,p=e.attr("id"),u=c.$modal,f=u.find(".btn-prev"),m=u.find(".btn-next"),h=u.find(".btn-fullscreen"),v=u.find(".btn-borderless"),g=u.find(".btn-toggleheader"),w=c.$preview.find("#zoom-"+p);a=w.attr("data-template")||"generic",n=(t=w.find(".kv-file-content")).length?t.html():"",r=(e.data("caption")||"")+" "+(e.data("size")||""),u.find(".kv-zoom-title").html(r),o=u.find(".kv-zoom-body"),u.removeClass("kv-single-content"),i?(d=o.addClass("file-thumb-loading").clone().insertAfter(o),o.html(n).hide(),d.fadeOut("fast",function(){o.fadeIn("fast",function(){o.removeClass("file-thumb-loading")}),d.remove()})):o.html(n),(s=c.previewZoomSettings[a])&&(l=o.find(".kv-preview-data"),Z.addCss(l,"file-zoom-detail"),O.each(s,function(e,i){l.css(e,i),(l.attr("width")&&"width"===e||l.attr("height")&&"height"===e)&&l.removeAttr(e)})),u.data("previewId",p);var _=o.find("img");_.length&&Z.adjustOrientedImage(_,!0),c._handler(f,"click",function(){c._zoomSlideShow("prev",p)}),c._handler(m,"click",function(){c._zoomSlideShow("next",p)}),c._handler(h,"click",function(){c._resizeZoomDialog(!0)}),c._handler(v,"click",function(){c._resizeZoomDialog(!1)}),c._handler(g,"click",function(){var e,a=u.find(".modal-header"),i=u.find(".modal-body .floating-buttons"),t=a.find(".kv-zoom-actions"),n=function(e){var i=c.$modal.find(".kv-zoom-body"),t=c.zoomModalHeight;u.hasClass("file-zoom-fullscreen")&&(t=i.outerHeight(!0),e||(t-=a.outerHeight(!0))),i.css("height",e?t+e:t)};a.is(":visible")?(e=a.outerHeight(!0),a.slideUp("slow",function(){t.find(".btn").appendTo(i),n(e)})):(i.find(".btn").appendTo(t),a.slideDown("slow",function(){n()})),u.focus()}),c._handler(u,"keydown",function(e){var i=e.which||e.keyCode;37!==i||f.attr("disabled")||c._zoomSlideShow("prev",p),39!==i||m.attr("disabled")||c._zoomSlideShow("next",p)})},_zoomPreview:function(e){var i,t=this.$modal;if(!e.length)throw"Cannot zoom to detailed preview!";Z.initModal(t),t.html(this._getModalContent()),i=e.closest(Z.FRAMES),this._setZoomContent(i),t.modal("show"),this._initZoomButtons()},_zoomSlideShow:function(e,i){var t,a,n,r=this,o=r.$modal.find(".kv-zoom-actions .btn-"+e),l=r.$preview.find(Z.FRAMES).toArray(),s=l.length;if(!o.attr("disabled")){for(a=0;a<s;a++)if(O(l[a]).attr("id")===i){n="prev"===e?a-1:a+1;break}n<0||s<=n||!l[n]||((t=O(l[n])).length&&r._setZoomContent(t,!0),r._initZoomButtons(),r._raise("filezoom"+e,{previewId:i,modal:r.$modal}))}},_initZoomButton:function(){var i=this;i.$preview.find(".kv-file-zoom").each(function(){var e=O(this);i._handler(e,"click",function(){i._zoomPreview(e)})})},_clearObjects:function(e){e.find("video audio").each(function(){this.pause(),O(this).remove()}),e.find("img object div").each(function(){O(this).remove()})},_clearFileInput:function(){var e,i,t,a=this.$element;this.fileInputCleared=!0,Z.isEmpty(a.val())||(this.isIE9||this.isIE10?(e=a.closest("form"),i=O(document.createElement("form")),t=O(document.createElement("div")),a.before(t),e.length?e.after(i):t.after(i),i.append(a).trigger("reset"),t.before(a).remove(),i.remove()):a.val(""))},_resetUpload:function(){var e=this;e.uploadCache={content:[],config:[],tags:[],append:!0},e.uploadCount=0,e.uploadStatus={},e.uploadLog=[],e.uploadAsyncCount=0,e.loadedImages=[],e.totalImagesCount=0,e.$btnUpload.removeAttr("disabled"),e._setProgress(0),Z.addCss(e.$progress,"hide"),e._resetErrors(!1),e.ajaxAborted=!1,e.ajaxRequests=[],e._resetCanvas(),e.cacheInitialPreview={},e.overwriteInitial&&(e.initialPreview=[],e.initialPreviewConfig=[],e.initialPreviewThumbTags=[],e.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){var e=this;e.canvas&&e.imageCanvasContext&&e.imageCanvasContext.clearRect(0,0,e.canvas.width,e.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){var e,i,t=this;t.previewCache.count()?(e=t.previewCache.out(),t.$preview.html(e.content),t._setInitThumbAttr(),i=t.initialCaption?t.initialCaption:e.caption,t._setCaption(i)):(t._clearPreview(),t._initCaption()),t.showPreview&&(t._initZoom(),t._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){var e=this;e.showPreview&&!Z.isEmpty(e.defaultPreviewContent)&&(e.$preview.html('<div class="file-default-preview">'+e.defaultPreviewContent+"</div>"),e.$container.removeClass("file-input-new"),e._initClickable())},_resetPreviewThumbs:function(e){var i,t=this;if(e)return t._clearPreview(),void t.clearStack();t._hasInitialPreview()?(i=t.previewCache.out(),t.$preview.html(i.content),t._setInitThumbAttr(),t._setCaption(i.caption),t._initPreviewActions()):t._clearPreview()},_getLayoutTemplate:function(e){var i=this.layoutTemplates[e];return Z.isEmpty(this.customLayoutTags)?i:Z.replaceTags(i,this.customLayoutTags)},_getPreviewTemplate:function(e){var i=this.previewTemplates[e];return Z.isEmpty(this.customPreviewTags)?i:Z.replaceTags(i,this.customPreviewTags)},_getOutData:function(e,i,t){var a=this;return e=e||{},i=i||{},t=t||a.filestack.slice(0)||{},{form:a.formdata,files:t,filenames:a.filenames,filescount:a.getFilesCount(),extra:a._getExtraData(),response:i,reader:a.reader,jqXHR:e}},_getMsgSelected:function(e){var i=1===e?this.fileSingle:this.filePlural;return 0<e?this.msgSelected.replace("{n}",e).replace("{files}",i):this.msgNoFilesSelected},_getThumbs:function(e){return e=e||"",this.$preview.find(Z.FRAMES+":not(.file-preview-initial)"+e)},_getExtraData:function(e,i){var t=this.uploadExtraData;return"function"==typeof this.uploadExtraData&&(t=this.uploadExtraData(e,i)),t},_initXhr:function(e,n,r){var o=this;return e.upload&&e.upload.addEventListener("progress",function(e){var i=0,t=e.total,a=e.loaded||e.position;e.lengthComputable&&(i=Math.floor(a/t*100)),n?o._setAsyncUploadStatus(n,i,r):o._setProgress(i)},!1),e},_ajaxSubmit:function(e,i,t,a,n,r){var o,l=this;l._raise("filepreajax",[n,r])&&(l._uploadExtra(n,r),o=O.extend(!0,{},{xhr:function(){var e=O.ajaxSettings.xhr();return l._initXhr(e,n,l.getFileStack().length)},url:l.uploadUrl,type:"POST",dataType:"json",data:l.formdata,cache:!1,processData:!1,contentType:!1,beforeSend:e,success:i,complete:t,error:a},l.ajaxSettings),l.ajaxRequests.push(O.ajax(o)))},_mergeArray:function(e,i){var t=Z.cleanArray(this[e]),a=Z.cleanArray(i);this[e]=t.concat(a)},_initUploadSuccess:function(e,i,t){var a,n,r,o,l,s,d,c,p,u=this;u.showPreview&&"object"==typeof e&&!O.isEmptyObject(e)&&void 0!==e.initialPreview&&0<e.initialPreview.length&&(u.hasInitData=!0,s=e.initialPreview||[],d=e.initialPreviewConfig||[],c=e.initialPreviewThumbTags||[],a=!(void 0!==e.append&&!e.append),0<s.length&&!Z.isArray(s)&&(s=s.split(u.initialPreviewDelimiter)),u._mergeArray("initialPreview",s),u._mergeArray("initialPreviewConfig",d),u._mergeArray("initialPreviewThumbTags",c),void 0!==i?t?(p=i.attr("data-fileindex"),u.uploadCache.content[p]=s[0],u.uploadCache.config[p]=d[0]||[],u.uploadCache.tags[p]=c[0]||[],u.uploadCache.append=a):(r=u.previewCache.add(s,d[0],c[0],a),n=u.previewCache.get(r,!1),(l=(o=O(document.createElement("div")).html(n).hide().insertAfter(i)).find(".kv-zoom-cache"))&&l.length&&l.insertAfter(i),i.fadeOut("slow",function(){var e=o.find(".file-preview-frame");e&&e.length&&e.insertBefore(i).fadeIn("slow").css("display:inline-block"),u._initPreviewActions(),u._clearFileInput(),Z.cleanZoomCache(u.$preview.find("#zoom-"+i.attr("id"))),i.remove(),o.remove(),u._initSortable()})):(u.previewCache.set(s,d,c,a),u._initPreview(),u._initPreviewActions()))},_initSuccessThumbs:function(){var n=this;n.showPreview&&n._getThumbs(Z.FRAMES+".file-preview-success").each(function(){var t=O(this),a=n.$preview,e=t.find(".kv-file-remove");e.removeAttr("disabled"),n._handler(e,"click",function(){var e=t.attr("id"),i=n._raise("filesuccessremove",[e,t.attr("data-fileindex")]);Z.cleanMemory(t),!1!==i&&t.fadeOut("slow",function(){Z.cleanZoomCache(a.find("#zoom-"+e)),t.remove(),a.find(Z.FRAMES).length||n.reset()})})})},_checkAsyncComplete:function(){var e,i,t=this;for(i=0;i<t.filestack.length;i++)if(t.filestack[i]&&(e=t.previewInitId+"-"+i,-1===O.inArray(e,t.uploadLog)))return!1;return t.uploadAsyncCount===t.uploadLog.length},_uploadExtra:function(e,i){var t=this,a=t._getExtraData(e,i);0!==a.length&&O.each(a,function(e,i){t.formdata.append(e,i)})},_uploadSingle:function(r,o,l){var n,s,e,d,i,t,a,c,p,u,f=this,m=f.getFileStack().length,h=new FormData,v=f.previewInitId+"-"+r,g=0<f.filestack.length||!O.isEmptyObject(f.uploadExtraData),w=O("#"+v).find(".file-thumb-progress"),_={id:v,index:r};f.formdata=h,f.showPreview&&(s=O("#"+v+":not(.file-preview-initial)"),d=s.find(".kv-file-upload"),i=s.find(".kv-file-remove"),w.removeClass("hide")),0===m||!g||d&&d.hasClass("disabled")||f._abort(_)||(u=function(e,i){f.updateStack(e,void 0),f.uploadLog.push(i),f._checkAsyncComplete()&&(f.fileBatchCompleted=!0)},e=function(){var e,i,t,a=f.uploadCache,n=0,r=f.cacheInitialPreview;f.fileBatchCompleted&&(r&&r.content&&(n=r.content.length),setTimeout(function(){if(f.showPreview){if(f.previewCache.set(a.content,a.config,a.tags,a.append),n){for(i=0;i<a.content.length;i++)t=i+n,r.content[t]=a.content[i],r.config.length&&(r.config[t]=a.config[i]),r.tags.length&&(r.tags[t]=a.tags[i]);f.initialPreview=Z.cleanArray(r.content),f.initialPreviewConfig=Z.cleanArray(r.config),f.initialPreviewThumbTags=Z.cleanArray(r.tags)}else f.initialPreview=a.content,f.initialPreviewConfig=a.config,f.initialPreviewThumbTags=a.tags;f.cacheInitialPreview={},f.hasInitData&&(f._initPreview(),f._initPreviewActions())}f.unlock(),f._clearFileInput(),e=f.$preview.find(".file-preview-initial"),f.uploadAsync&&e.length&&(Z.addCss(e,Z.SORT_CSS),f._initSortable()),f._raise("filebatchuploadcomplete",[f.filestack,f._getExtraData()]),f.uploadCount=0,f.uploadStatus={},f.uploadLog=[],f._setProgress(101)},100))},t=function(e){n=f._getOutData(e),f.fileBatchCompleted=!1,f.showPreview&&(s.hasClass("file-preview-success")||(f._setThumbStatus(s,"Loading"),Z.addCss(s,"file-uploading")),d.attr("disabled",!0),i.attr("disabled",!0)),l||f.lock(),f._raise("filepreupload",[n,v,r]),O.extend(!0,_,n),f._abort(_)&&(e.abort(),f._setProgressCancelled())},a=function(e,i,t){var a=f.showPreview&&s.attr("id")?s.attr("id"):v;n=f._getOutData(t,e),O.extend(!0,_,n),setTimeout(function(){Z.isEmpty(e)||Z.isEmpty(e.error)?(f.showPreview&&(f._setThumbStatus(s,"Success"),d.hide(),f._initUploadSuccess(e,s,l),f._setProgress(101,w)),f._raise("fileuploaded",[n,a,r]),l?u(r,a):f.updateStack(r,void 0)):(f._showUploadError(e.error,_),f._setPreviewError(s,r),l&&u(r,a))},100)},c=function(){setTimeout(function(){f.showPreview&&(d.removeAttr("disabled"),i.removeAttr("disabled"),s.removeClass("file-uploading")),l?e():(f.unlock(!1),f._clearFileInput()),f._initSuccessThumbs()},100)},p=function(e,i,t){var a=f.ajaxOperations.uploadThumb,n=f._parseError(a,e,t,l?o[r].name:null);setTimeout(function(){l&&u(r,v),f.uploadStatus[v]=100,f._setPreviewError(s,r),O.extend(!0,_,f._getOutData(e)),f._setProgress(101,w,f.msgAjaxProgressError.replace("{operation}",a)),f._showUploadError(n,_)},100)},h.append(f.uploadFileAttr,o[r],f.filenames[r]),h.append("file_id",r),f._ajaxSubmit(t,a,c,p,v,r))},_uploadBatch:function(){var e,i,t,a,l,s=this,n=s.filestack,o=n.length,r=0<s.filestack.length||!O.isEmptyObject(s.uploadExtraData);s.formdata=new FormData,0!==o&&r&&!s._abort({})&&(l=function(){O.each(n,function(e){s.updateStack(e,void 0)}),s._clearFileInput()},e=function(e){s.lock();var i=s._getOutData(e);s.showPreview&&s._getThumbs().each(function(){var e=O(this),i=e.find(".kv-file-upload"),t=e.find(".kv-file-remove");e.hasClass("file-preview-success")||(s._setThumbStatus(e,"Loading"),Z.addCss(e,"file-uploading")),i.attr("disabled",!0),t.attr("disabled",!0)}),s._raise("filebatchpreupload",[i]),s._abort(i)&&(e.abort(),s._setProgressCancelled())},i=function(e,i,t){var a=s._getOutData(t,e),n=s._getThumbs(":not(.file-preview-error)"),r=0,o=Z.isEmpty(e)||Z.isEmpty(e.errorkeys)?[]:e.errorkeys;Z.isEmpty(e)||Z.isEmpty(e.error)?(s._raise("filebatchuploadsuccess",[a]),l(),s.showPreview?(n.each(function(){var e=O(this),i=e.find(".kv-file-upload");e.find(".kv-file-upload").hide(),s._setThumbStatus(e,"Success"),e.removeClass("file-uploading"),i.removeAttr("disabled")}),s._initUploadSuccess(e)):s.reset(),s._setProgress(101)):(s.showPreview&&(n.each(function(){var e=O(this),i=e.find(".kv-file-remove"),t=e.find(".kv-file-upload");e.removeClass("file-uploading"),t.removeAttr("disabled"),i.removeAttr("disabled"),0!==o.length?(-1!==O.inArray(r,o)?s._setPreviewError(e):(e.find(".kv-file-upload").hide(),s._setThumbStatus(e,"Success"),s.updateStack(r,void 0)),r++):s._setPreviewError(e)}),s._initUploadSuccess(e)),s._showUploadError(e.error,a,"filebatchuploaderror"))},a=function(){s.unlock(),s._initSuccessThumbs(),s._clearFileInput(),s._raise("filebatchuploadcomplete",[s.filestack,s._getExtraData()])},t=function(e,i,t){var a=s._getOutData(e),n=s.ajaxOperations.uploadBatch,r=s._parseError(n,e,t);s._showUploadError(r,a,"filebatchuploaderror"),s.uploadFileCount=o-1,s.showPreview&&(s._getThumbs().each(function(){var e=O(this),i=e.attr("data-fileindex");e.removeClass("file-uploading"),void 0!==s.filestack[i]&&s._setPreviewError(e)}),s._getThumbs().removeClass("file-uploading"),s._getThumbs(" .kv-file-upload").removeAttr("disabled"),s._getThumbs(" .kv-file-delete").removeAttr("disabled"),s._setProgress(101,s.$progress,s.msgAjaxProgressError.replace("{operation}",n)))},O.each(n,function(e,i){Z.isEmpty(n[e])||s.formdata.append(s.uploadFileAttr,i,s.filenames[e])}),s._ajaxSubmit(e,i,a,t))},_uploadExtraOnly:function(){var e,i,t,a,o=this,l={};o.formdata=new FormData,o._abort(l)||(e=function(e){o.lock();var i=o._getOutData(e);o._raise("filebatchpreupload",[i]),o._setProgress(50),l.data=i,l.xhr=e,o._abort(l)&&(e.abort(),o._setProgressCancelled())},i=function(e,i,t){var a=o._getOutData(t,e);Z.isEmpty(e)||Z.isEmpty(e.error)?(o._raise("filebatchuploadsuccess",[a]),o._clearFileInput(),o._initUploadSuccess(e),o._setProgress(101)):o._showUploadError(e.error,a,"filebatchuploaderror")},t=function(){o.unlock(),o._clearFileInput(),o._raise("filebatchuploadcomplete",[o.filestack,o._getExtraData()])},a=function(e,i,t){var a=o._getOutData(e),n=o.ajaxOperations.uploadExtra,r=o._parseError(n,e,t);l.data=a,o._showUploadError(r,a,"filebatchuploaderror"),o._setProgress(101,o.$progress,o.msgAjaxProgressError.replace("{operation}",n))},o._ajaxSubmit(e,i,t,a))},_deleteFileIndex:function(e){var i=this,t=e.attr("data-fileindex");"init_"===t.substring(0,5)&&(t=parseInt(t.replace("init_","")),i.initialPreview=Z.spliceArray(i.initialPreview,t),i.initialPreviewConfig=Z.spliceArray(i.initialPreviewConfig,t),i.initialPreviewThumbTags=Z.spliceArray(i.initialPreviewThumbTags,t),i.$preview.find(Z.FRAMES).each(function(){var e=O(this),i=e.attr("data-fileindex");"init_"===i.substring(0,5)&&(i=parseInt(i.replace("init_","")),t<i&&(i--,e.attr("data-fileindex","init_"+i)))}),i.uploadAsync&&(i.cacheInitialPreview=i.getPreview()))},_initFileActions:function(){var c=this,p=c.$preview;c.showPreview&&(c._initZoomButton(),p.find(Z.FRAMES+" .kv-file-remove").each(function(){var n,r,o,e=O(this),l=e.closest(Z.FRAMES),s=l.attr("id"),d=l.attr("data-fileindex");c._handler(e,"click",function(){if(!1===c._raise("filepreremove",[s,d])||!c._validateMinCount())return!1;n=l.hasClass("file-preview-error"),Z.cleanMemory(l),l.fadeOut("slow",function(){Z.cleanZoomCache(p.find("#zoom-"+s)),c.updateStack(d,void 0),c._clearObjects(l),l.remove(),s&&n&&c.$errorContainer.find('li[data-file-id="'+s+'"]').fadeOut("fast",function(){O(this).remove(),c._errorsExist()||c._resetErrors()}),c._clearFileInput();var e=c.getFileStack(!0),i=c.previewCache.count(),t=e.length,a=c.showPreview&&p.find(Z.FRAMES).length;0!==t||0!==i||a?(o=1<(r=i+t)?c._getMsgSelected(r):e[0]?c._getFileNames()[0]:"",c._setCaption(o)):c.reset(),c._raise("fileremoved",[s,d])})})}),c.$preview.find(Z.FRAMES+" .kv-file-upload").each(function(){var t=O(this);c._handler(t,"click",function(){var e=t.closest(Z.FRAMES),i=e.attr("data-fileindex");e.hasClass("file-preview-error")||c._uploadSingle(i,c.filestack,!1)})}))},_initPreviewActions:function(){var p=this,u=p.$preview,n=p.deleteExtraData||{},i=Z.FRAMES+" .kv-file-remove",f=function(){var e=p.isUploadable?p.previewCache.count():p.$element.get(0).files.length;0!==u.find(i).length||e||(p.reset(),p.initialCaption="")};p._initZoomButton(),u.find(i).each(function(){var r=O(this),e=r.data("url")||p.deleteUrl,o=r.data("key");if(!Z.isEmpty(e)&&void 0!==o){var i,l,t,s,d=r.closest(Z.FRAMES),a=p.previewCache.data,c=d.attr("data-fileindex");c=parseInt(c.replace("init_","")),t=Z.isEmpty(a.config)&&Z.isEmpty(a.config[c])?null:a.config[c],"function"==typeof(s=Z.isEmpty(t)||Z.isEmpty(t.extra)?n:t.extra)&&(s=s()),l={id:r.attr("id"),key:o,extra:s},i=O.extend(!0,{},{url:e,type:"POST",dataType:"json",data:O.extend(!0,{},{key:o},s),beforeSend:function(e){p.ajaxAborted=!1,p._raise("filepredelete",[o,e,s]),p.ajaxAborted?e.abort():(Z.addCss(d,"file-uploading"),Z.addCss(r,"disabled"))},success:function(e,i,t){var a,n;if(!Z.isEmpty(e)&&!Z.isEmpty(e.error))return l.jqXHR=t,l.response=e,p._showError(e.error,l,"filedeleteerror"),d.removeClass("file-uploading"),r.removeClass("disabled"),void f();c=parseInt(d.attr("data-fileindex").replace("init_","")),p.previewCache.unset(c),n=0<(a=p.previewCache.count())?p._getMsgSelected(a):"",p._deleteFileIndex(d),p._setCaption(n),p._raise("filedeleted",[o,t,s]),d.removeClass("file-uploading").addClass("file-deleted"),d.fadeOut("slow",function(){Z.cleanZoomCache(u.find("#zoom-"+d.attr("id"))),p._clearObjects(d),d.remove(),f(),a||0!==p.getFileStack().length||(p._setCaption(""),p.reset())})},error:function(e,i,t){var a=p.ajaxOperations.deleteThumb,n=p._parseError(a,e,t);l.jqXHR=e,l.response={},p._showError(n,l,"filedeleteerror"),d.removeClass("file-uploading"),f()}},p.ajaxDeleteSettings),p._handler(r,"click",function(){if(!p._validateMinCount())return!1;O.ajax(i)})}})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.find(".kv-caption-icon").hide()},_showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},_getSize:function(e){var i,t,a,n=parseFloat(e),r=this.fileSizeGetter;return O.isNumeric(e)&&O.isNumeric(n)?("function"==typeof r?a=r(n):0===n?a="0.00 B":(i=Math.floor(Math.log(n)/Math.log(1024)),t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a=1*(n/Math.pow(1024,i)).toFixed(2)+" "+t[i]),this._getLayoutTemplate("size").replace("{sizeText}",a)):""},_generatePreviewTemplate:function(l,e,s,d,c,i,t,p,a,u,f){var m=this,h=m.slug(s),n="",r=m.previewSettings[l]||m.defaults.previewSettings[l],v=r&&r.width?r.width:"",g=r&&r.height?r.height:"",w=a||m._renderFileFooter(h,t,Z.isEmpty(v)?"auto":v,i),o=m._getPreviewIcon(s),_="type-default",b=o&&m.preferIconicPreview,C=o&&m.preferIconicZoomPreview,y=function(e,i,t,a){var n=t?"zoom-"+c:c,r=m._getPreviewTemplate(e),o=(p||"")+" "+a;return m.frameClass&&(o=m.frameClass+" "+o),t&&(o=o.replace(" "+Z.SORT_CSS,"")),r=m._parseFilePreviewIcon(r,s),"text"===e&&(i=Z.htmlEncode(i)),"object"!==l||d||O.each(m.defaults.fileTypeSettings,function(e,i){"object"!==e&&"other"!==e&&i(s,d)&&(_="type-"+e)}),r.setTokens({previewId:n,caption:h,frameClass:o,type:d,fileindex:u,width:v,height:g,typeCss:_,footer:w,data:i,template:f||l})};return u=u||c.slice(c.lastIndexOf("-")+1),m.fileActionSettings.showZoom&&(n=y(C?"other":l,e,!0,"kv-zoom-thumb")),n="\n"+m._getLayoutTemplate("zoomCache").replace("{zoomContent}",n),y(b?"other":l,e,!1,"kv-preview-thumb")+n},_previewDefault:function(e,i,t){var a=this,n=a.$preview;if(a.showPreview){var r,o=e?e.name:"",l=e?e.type:"",s=e.size||0,d=a.slug(o),c=!0===t&&!a.isUploadable,p=Z.objUrl.createObjectURL(e);a._clearDefaultPreview(),r=a._generatePreviewTemplate("other",p,o,l,i,c,s),n.append("\n"+r),a._setThumbAttr(i,d,s),!0===t&&a.isUploadable&&a._setThumbStatus(O("#"+i),"Error")}},_previewFile:function(e,a,i,n,t){if(this.showPreview){var r,o=this,l=o._parseFileType(a),s=a?a.name:"",d=o.slug(s),c=o.allowedPreviewTypes,p=o.allowedPreviewMimeTypes,u=o.$preview,f=c&&0<=c.indexOf(l),m=a.size||0,h=a.type,v="text"===l||"html"===l||"image"===l?i.target.result:t,g=p&&-1!==p.indexOf(h);if("html"===l&&o.purifyHtml&&window.DOMPurify&&(v=window.DOMPurify.sanitize(v)),f||g){r=o._generatePreviewTemplate(l,v,s,h,n,!1,m),o._clearDefaultPreview(),u.append("\n"+r);var w=u.find("#"+n+" img");w.length&&o.autoOrientImage?Z.validateOrientation(a,function(e){if(e){var i=u.find("#zoom-"+n+" img"),t="rotate-"+e;4<e&&(t+=w.width()>w.height()?" is-portrait-gt4":" is-landscape-gt4"),Z.addCss(w,t),Z.addCss(i,t),o._raise("fileimageoriented",{$img:w,file:a})}o._validateImage(n,d,h,m),Z.adjustOrientedImage(w)}):o._validateImage(n,d,h,m)}else o._previewDefault(a,n);o._setThumbAttr(n,d,m),o._initSortable()}},_setThumbAttr:function(e,i,t){var a=O("#"+e);a.length&&(t=t&&0<t?this._getSize(t):"",a.data({caption:i,size:t}))},_setInitThumbAttr:function(){var e,i,t,a,n=this.previewCache.data,r=this.previewCache.count(!0);if(0!==r)for(var o=0;o<r;o++)e=n.config[o],a=this.previewInitId+"-init_"+o,i=Z.ifSet("caption",e,Z.ifSet("filename",e)),t=Z.ifSet("size",e),this._setThumbAttr(a,i,t)},_slugDefault:function(e){return Z.isEmpty(e)?"":String(e).replace(/[\-\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_readFiles:function(_){this.reader=new FileReader;var b,C=this,y=C.$element,E=C.$preview,T=C.reader,x=C.$previewContainer,S=C.$previewStatus,F=C.msgLoading,I=C.msgProgress,k=C.previewInitId,P=_.length,z=C.fileTypeSettings,A=C.filestack.length,$=C.allowedFileTypes,D=$?$.length:0,U=C.allowedFileExtensions,j=Z.isEmpty(U)?"":U.join(", "),R=C.maxFilePreviewSize&&parseFloat(C.maxFilePreviewSize),L=E.length&&(!R||isNaN(R)),M=function(e,i,t,a){var n=O.extend(!0,{},C._getOutData({},{},_),{id:t,index:a}),r={id:t,index:a,file:i,files:_};return C._previewDefault(i,t,!0),C.isUploadable&&(C.addToStack(void 0),setTimeout(function(){b(a+1)},100)),C._initFileActions(),C.removeFromPreviewOnError&&O("#"+t).remove(),C.isUploadable?C._showUploadError(e,n):C._showError(e,r)};C.loadedImages=[],C.totalImagesCount=0,O.each(_,function(e,i){var t=C.fileTypeSettings.image;t&&t(i.type)&&C.totalImagesCount++}),(b=function(a){if(Z.isEmpty(y.attr("multiple"))&&(P=1),P<=a)return C.isUploadable&&0<C.filestack.length?C._raise("filebatchselected",[C.getFileStack()]):C._raise("filebatchselected",[_]),x.removeClass("file-thumb-loading"),void S.html("");var e,i,t,n,r,o,l,s,d,c,p=k+"-"+(A+a),u=_[a],f=u.name?C.slug(u.name):"",m=(u.size||0)/1e3,h="",v=Z.objUrl.createObjectURL(u),g=0,w="";if(0<D)for(n=0;n<D;n++)s=$[n],d=C.msgFileTypes[s]||s,w+=0===n?d:", "+d;if(!1!==f){if(0===f.length)return r=C.msgInvalidFileName.replace("{name}",Z.htmlEncode(u.name)),void(C.isError=M(r,u,p,a));if(Z.isEmpty(U)||(h=new RegExp("\\.("+U.join("|")+")$","i")),t=m.toFixed(2),0<C.maxFileSize&&m>C.maxFileSize)return r=C.msgSizeTooLarge.setTokens({name:f,size:t,maxSize:C.maxFileSize}),void(C.isError=M(r,u,p,a));if(null!==C.minFileSize&&m<=Z.getNum(C.minFileSize))return r=C.msgSizeTooSmall.setTokens({name:f,size:t,minSize:C.minFileSize}),void(C.isError=M(r,u,p,a));if(!Z.isEmpty($)&&Z.isArray($)){for(n=0;n<$.length;n+=1)o=$[n],g+=(c=z[o])&&"function"==typeof c&&c(u.type,u.name)?1:0;if(0===g)return r=C.msgInvalidFileType.setTokens({name:f,types:w}),void(C.isError=M(r,u,p,a))}if(0===g&&!Z.isEmpty(U)&&Z.isArray(U)&&!Z.isEmpty(h)&&(l=Z.compare(f,h),0===(g+=Z.isEmpty(l)?0:l.length)))return r=C.msgInvalidFileExtension.setTokens({name:f,extensions:j}),void(C.isError=M(r,u,p,a));if(!C.showPreview)return C.isUploadable&&C.addToStack(u),setTimeout(function(){b(a+1),C._updateFileDetails(P)},100),void C._raise("fileloaded",[u,p,a,T]);if(!L&&R<m)return C.addToStack(u),x.addClass("file-thumb-loading"),C._previewDefault(u,p),C._initFileActions(),C._updateFileDetails(P),void b(a+1);E.length&&void 0!==FileReader?(S.html(F.replace("{index}",a+1).replace("{files}",P)),x.addClass("file-thumb-loading"),T.onerror=function(e){C._errorHandler(e,f)},T.onload=function(e){C._previewFile(a,u,e,p,v),C._initFileActions()},T.onloadend=function(){r=I.setTokens({index:a+1,files:P,percent:50,name:f}),setTimeout(function(){S.html(r),C._updateFileDetails(P),b(a+1)},100),C._raise("fileloaded",[u,p,a,T])},T.onprogress=function(e){if(e.lengthComputable){var i=e.loaded/e.total*100,t=Math.ceil(i);r=I.setTokens({index:a+1,files:P,percent:t,name:f}),setTimeout(function(){S.html(r)},100)}},e=z.text,i=z.image,e(u.type,f)?T.readAsText(u,C.textEncoding):i(u.type,f)?T.readAsDataURL(u):T.readAsArrayBuffer(u)):(C._previewDefault(u,p),setTimeout(function(){b(a+1),C._updateFileDetails(P)},100),C._raise("fileloaded",[u,p,a,T])),C.addToStack(u)}else b(a+1)})(0),C._updateFileDetails(P,!1)},_updateFileDetails:function(e){var i=this,t=i.$element,a=i.getFileStack(),n=Z.isIE(9)&&Z.findFileName(t.val())||t[0].files[0]&&t[0].files[0].name||a.length&&a[0].name||"",r=i.slug(n),o=i.isUploadable?a.length:e,l=i.previewCache.count()+o,s=1<o?i._getMsgSelected(l):r;i.isError?(i.$previewContainer.removeClass("file-thumb-loading"),i.$previewStatus.html(""),i.$captionContainer.find(".kv-caption-icon").hide()):i._showFileIcon(),i._setCaption(s,i.isError),i.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&i._raise("fileselect",[e,r]),i.previewCache.count()&&i._initPreviewActions()},_setThumbStatus:function(e,i){if(this.showPreview){var t="indicator"+i,a=t+"Title",n="file-preview-"+i.toLowerCase(),r=e.find(".file-upload-indicator"),o=this.fileActionSettings;e.removeClass("file-preview-success file-preview-error file-preview-loading"),"Error"===i&&e.find(".kv-file-upload").attr("disabled",!0),"Success"===i&&(e.find(".file-drag-handle").remove(),r.css("margin-left",0)),r.html(o[t]),r.attr("title",o[a]),e.addClass(n)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(e,i,t){var a,n=this,r=Math.min(e,100),o=n.progressUploadThreshold,l=e<=100?n.progressTemplate:n.progressCompleteTemplate,s=r<100?n.progressTemplate:t?n.progressErrorTemplate:l;i=i||n.$progress,Z.isEmpty(s)||(a=o&&o<r&&e<=100?s.setTokens({percent:o,status:n.msgUploadThreshold}):s.setTokens({percent:r,status:100<e?n.msgUploadEnd:r+"%"}),i.html(a),t&&i.find('[role="progressbar"]').html(t))},_setFileDropZoneTitle:function(){var e,i=this,t=i.$container.find(".file-drop-zone"),a=i.dropZoneTitle;i.isClickable&&(e=Z.isEmpty(i.$element.attr("multiple"))?i.fileSingle:i.filePlural,a+=i.dropZoneClickTitle.replace("{files}",e)),t.find("."+i.dropZoneTitleClass).remove(),i.isUploadable&&i.showPreview&&0!==t.length&&!(0<i.getFileStack().length)&&i.dropZoneEnabled&&(0===t.find(Z.FRAMES).length&&Z.isEmpty(i.defaultPreviewContent)&&t.prepend('<div class="'+i.dropZoneTitleClass+'">'+a+"</div>"),i.$container.removeClass("file-input-new"),Z.addCss(i.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(e,i,t){var a=0;this._setProgress(i,O("#"+e).find(".file-thumb-progress")),this.uploadStatus[e]=i,O.each(this.uploadStatus,function(e,i){a+=i}),this._setProgress(Math.floor(a/t))},_validateMinCount:function(){var e=this,i=e.isUploadable?e.getFileStack().length:e.$element.get(0).files.length;return!(e.validateInitialCount&&0<e.minFileCount&&e._getFileCount(i-1)<e.minFileCount)||(e._noFilesError({}),!1)},_getFileCount:function(e){return this.validateInitialCount&&!this.overwriteInitial&&(e+=this.previewCache.count()),e},_getFileId:function(e){var i,t=this.generateFileId;return"function"==typeof t?t(e,event):e&&(i=e.webkitRelativePath||e.fileName||e.name||null)?e.size+"-"+i.replace(/[^0-9a-zA-Z_-]/gim,""):null},_getFileName:function(e){return e&&e.name?this.slug(e.name):void 0},_getFileIds:function(i){return this.fileids.filter(function(e){return i?void 0!==e:null!=e})},_getFileNames:function(i){return this.filenames.filter(function(e){return i?void 0!==e:null!=e})},_setPreviewError:function(e,i,t){void 0!==i&&this.updateStack(i,t),this.removeFromPreviewOnError?e.remove():this._setThumbStatus(e,"Error")},_checkDimensions:function(e,i,t,a,n,r,o){var l,s,d,c=this[("Small"===i?"min":"max")+"Image"+r];!Z.isEmpty(c)&&t.length&&(d=t[0],s="Width"===r?d.naturalWidth||d.width:d.naturalHeight||d.height,("Small"===i?c<=s:s<=c)||(l=this["msgImage"+r+i].setTokens({name:n,size:c}),this._showUploadError(l,o),this._setPreviewError(a,e,null)))},_validateImage:function(e,i,t,a){var n,r,o=this,l=o.$preview,s=l.find("#"+e),d=s.attr("data-fileindex"),c=s.find("img");i=i||"Untitled",c.length&&o._handler(c,"load",function(){r=s.width(),l.width()<r&&(c.css("width","100%"),s.css("width","97%")),n={ind:d,id:e},o._checkDimensions(d,"Small",c,s,i,"Width",n),o._checkDimensions(d,"Small",c,s,i,"Height",n),o.resizeImage||(o._checkDimensions(d,"Large",c,s,i,"Width",n),o._checkDimensions(d,"Large",c,s,i,"Height",n)),o._raise("fileimageloaded",[e]),o.loadedImages.push({ind:d,img:c,thumb:s,pid:e,typ:t,siz:a,validated:!1}),o._validateAllImages()})},_validateAllImages:function(){var e,i,t,a=this,n={val:0},r=a.loadedImages.length,o=a.resizeIfSizeMoreThan;if(r===a.totalImagesCount&&(a._raise("fileimagesloaded"),a.resizeImage))for(e=0;e<a.loadedImages.length;e++)(i=a.loadedImages[e]).validated||((t=i.siz)&&1e3*o<t&&a._getResizedImage(i,n,r),a.loadedImages[e].validated=!0)},_getResizedImage:function(e,i,t){var a,n,r,o,l=this,s=O(e.img)[0],d=s.naturalWidth,c=s.naturalHeight,p=1,u=l.maxImageWidth||d,f=l.maxImageHeight||c,m=!(!d||!c),h=l.imageCanvas,v=l.imageCanvasContext,g=e.typ,w=e.pid,_=e.ind,b=e.thumb;if(r=function(e,i,t){l.isUploadable?l._showUploadError(e,i,t):l._showError(e,i,t),l._setPreviewError(b,_)},l.filestack[_]&&m&&!(d<=u&&c<=f)||(m&&l.filestack[_]&&l._raise("fileimageresized",[w,_]),i.val++,i.val===t&&l._raise("fileimagesresized"),m)){g=g||l.resizeDefaultImageType,a=u<d,n=f<c,p="width"===l.resizePreference?a?u/d:n?f/c:1:n?f/c:a?u/d:1,l._resetCanvas(),d*=p,c*=p,h.width=d,h.height=c;try{v.drawImage(s,0,0,d,c),h.toBlob(function(e){l.filestack[_]=e,l._raise("fileimageresized",[w,_]),i.val++,i.val===t&&l._raise("fileimagesresized",[void 0,void 0]),e instanceof Blob||r(l.msgImageResizeError,{id:w,index:_},"fileimageresizeerror")},g,l.resizeQuality)}catch(e){i.val++,i.val===t&&l._raise("fileimagesresized",[void 0,void 0]),o=l.msgImageResizeException.replace("{errors}",e.message),r(o,{id:w,index:_},"fileimageresizeexception")}}else r(l.msgImageResizeError,{id:w,index:_},"fileimageresizeerror")},_initBrowse:function(e){var i=this;i.showBrowse?(i.$btnFile=e.find(".btn-file"),i.$btnFile.append(i.$element)):i.$element.hide()},_initCaption:function(){var e=this.initialCaption||"";return this.overwriteInitial||Z.isEmpty(e)?(this.$caption.html(""),!1):(this._setCaption(e),!0)},_setCaption:function(e,i){var t,a,n,r,o=this,l=o.getFileStack();if(o.$caption.length){if(i)t=O("<div>"+o.msgValidationError+"</div>").text(),r=(n=l.length)?1===n&&l[0]?o._getFileNames()[0]:o._getMsgSelected(n):o._getMsgSelected(o.msgNo),a='<span class="'+o.msgValidationErrorClass+'">'+o.msgValidationErrorIcon+(Z.isEmpty(e)?r:e)+"</span>";else{if(Z.isEmpty(e))return;t=O("<div>"+e+"</div>").text(),a=o._getLayoutTemplate("fileIcon")+t}o.$caption.html(a),o.$caption.attr("title",t),o.$captionContainer.find(".file-caption-ellipsis").attr("title",t)}},_createContainer:function(){var e=this,i=O(document.createElement("div")).attr({class:"file-input file-input-new"}).html(e._renderMain());return e.$element.before(i),e._initBrowse(i),e.theme&&i.addClass("theme-"+e.theme),i},_refreshContainer:function(){var e=this.$container;e.before(this.$element),e.html(this._renderMain()),this._initBrowse(e)},_renderMain:function(){var e=this,i=e.isUploadable&&e.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",t=e.showClose?e._getLayoutTemplate("close"):"",a=e.showPreview?e._getLayoutTemplate("preview").setTokens({class:e.previewClass,dropClass:i}):"",n=e.isDisabled?e.captionClass+" file-caption-disabled":e.captionClass,r=e.captionTemplate.setTokens({class:n+" kv-fileinput-caption"});return e.mainTemplate.setTokens({class:e.mainClass+(!e.showBrowse&&e.showCaption?" no-browse":""),preview:a,close:t,caption:r,upload:e._renderButton("upload"),remove:e._renderButton("remove"),cancel:e._renderButton("cancel"),browse:e._renderButton("browse")})},_renderButton:function(e){var i=this,t=i._getLayoutTemplate("btnDefault"),a=i[e+"Class"],n=i[e+"Title"],r=i[e+"Icon"],o=i[e+"Label"],l=i.isDisabled?" disabled":"",s="button";switch(e){case"remove":if(!i.showRemove)return"";break;case"cancel":if(!i.showCancel)return"";a+=" hide";break;case"upload":if(!i.showUpload)return"";i.isUploadable&&!i.isDisabled?t=i._getLayoutTemplate("btnLink").replace("{href}",i.uploadUrl):s="submit";break;case"browse":if(!i.showBrowse)return"";t=i._getLayoutTemplate("btnBrowse");break;default:return""}return a+="browse"===e?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",Z.isEmpty(o)||(o=' <span class="'+i.buttonLabelClass+'">'+o+"</span>"),t.setTokens({type:s,css:a,title:n,status:l,icon:r,label:o})},_renderThumbProgress:function(){return'<div class="file-thumb-progress hide">'+this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(e,i,t,a){var n,r=this,o=r.fileActionSettings,l=o.showRemove,s=o.showDrag,d=o.showUpload,c=o.showZoom,p=r._getLayoutTemplate("footer"),u=a?o.indicatorError:o.indicatorNew,f=r._getLayoutTemplate("indicator"),m=a?o.indicatorErrorTitle:o.indicatorNewTitle,h=f.setTokens({indicator:u,indicatorTitle:m});return i=r._getSize(i),n=r.isUploadable?p.setTokens({actions:r._renderFileActions(d,l,c,s,!1,!1,!1),caption:e,size:i,width:t,progress:r._renderThumbProgress(),indicator:h}):p.setTokens({actions:r._renderFileActions(!1,!1,c,s,!1,!1,!1),caption:e,size:i,width:t,progress:"",indicator:h}),n=Z.replaceTags(n,r.previewThumbTags)},_renderFileActions:function(e,i,t,a,n,r,o,l){if(!(e||i||t||a))return"";var s,d=this,c=!1===r?"":' data-url="'+r+'"',p=!1===o?"":' data-key="'+o+'"',u="",f="",m="",h="",v=d._getLayoutTemplate("actions"),g=d.fileActionSettings,w=d.otherActionButtons.setTokens({dataKey:p}),_=n?g.removeClass+" disabled":g.removeClass;return i&&(u=d._getLayoutTemplate("actionDelete").setTokens({removeClass:_,removeIcon:g.removeIcon,removeTitle:g.removeTitle,dataUrl:c,dataKey:p})),e&&(f=d._getLayoutTemplate("actionUpload").setTokens({uploadClass:g.uploadClass,uploadIcon:g.uploadIcon,uploadTitle:g.uploadTitle})),t&&(m=d._getLayoutTemplate("actionZoom").setTokens({zoomClass:g.zoomClass,zoomIcon:g.zoomIcon,zoomTitle:g.zoomTitle})),a&&l&&(s="drag-handle-init "+g.dragClass,h=d._getLayoutTemplate("actionDrag").setTokens({dragClass:s,dragTitle:g.dragTitle,dragIcon:g.dragIcon})),v.setTokens({delete:u,upload:f,zoom:m,drag:h,other:w})},_browse:function(e){var i=this;i._raise("filebrowse"),e&&e.isDefaultPrevented()||(i.isError&&!i.isUploadable&&i.clear(),i.$captionContainer.focus())},_filterDuplicate:function(e,i,t){var a=this._getFileId(e);a&&t&&-1<t.indexOf(a)||(t||(t=[]),i.push(e),t.push(a))},_change:function(e){var t=this,i=t.$element;if(!t.isUploadable&&Z.isEmpty(i.val())&&t.fileInputCleared)t.fileInputCleared=!1;else{t.fileInputCleared=!1;var a,n,r,o,l,s,d,c,p,u,f=[],m=1<arguments.length,h=t.isUploadable,v=m?e.originalEvent.dataTransfer.files:i.get(0).files,g=t.filestack.length,w=Z.isEmpty(i.attr("multiple"))&&0<g,_=0,b=t._getFileIds();if(t.reader=null,t._resetUpload(),t._hideFileIcon(),t.isUploadable&&t.$container.find(".file-drop-zone ."+t.dropZoneTitleClass).remove(),m?O.each(v,function(e,i){i&&!i.type&&void 0!==i.size&&i.size%4096==0?_++:t._filterDuplicate(i,f,b)}):(v=e.target&&void 0===e.target.files?e.target.value?[{name:e.target.value.replace(/^.+\\/,"")}]:[]:e.target.files||{},h?O.each(v,function(e,i){t._filterDuplicate(i,f,b)}):f=v),Z.isEmpty(f)||0===f.length)return h||t.clear(),t._showFolderError(_),void t._raise("fileselectnone");if(t._resetErrors(),o=f.length,n=t._getFileCount(t.isUploadable?t.getFileStack().length+o:o),0<t.maxFileCount&&n>t.maxFileCount){if(!t.autoReplace||o>t.maxFileCount)return r=t.autoReplace&&o>t.maxFileCount?o:n,a=t.msgFilesTooMany.replace("{m}",t.maxFileCount).replace("{n}",r),t.isError=(l=a,c=d=s=null,p=O.extend(!0,{},t._getOutData({},{},v),{id:d,index:c}),u={id:d,index:c,file:s,files:v},t.isUploadable?t._showUploadError(l,p):t._showError(l,u)),t.$captionContainer.find(".kv-caption-icon").hide(),t._setCaption("",!0),void t.$container.removeClass("file-input-new file-input-ajax-new");n>t.maxFileCount&&t._resetPreviewThumbs(h)}else!h||w?(t._resetPreviewThumbs(!1),w&&t.clearStack()):!h||0!==g||t.previewCache.count()&&!t.overwriteInitial||t._resetPreviewThumbs(!0);t.isPreviewable?t._readFiles(f):t._updateFileDetails(1),t._showFolderError(_)}},_abort:function(e){var i,t=this;return!(!t.ajaxAborted||"object"!=typeof t.ajaxAborted||void 0===t.ajaxAborted.message)&&((i=O.extend(!0,{},t._getOutData(),e)).abortData=t.ajaxAborted.data||{},i.abortMessage=t.ajaxAborted.message,t._setProgress(101,t.$progress,t.msgCancelled),t._showUploadError(t.ajaxAborted.message,i,"filecustomerror"),t.cancel(),!0)},_resetFileStack:function(){var r=this,o=0,l=[],s=[],d=[];r._getThumbs().each(function(){var e,i=O(this),t=i.attr("data-fileindex"),a=r.filestack[t],n=i.attr("id");"-1"!==t&&-1!==t&&(void 0!==a?(l[o]=a,s[o]=r._getFileName(a),d[o]=r._getFileId(a),i.attr({id:r.previewInitId+"-"+o,"data-fileindex":o}),o++):(e="uploaded-"+Z.uniqId(),i.attr({id:e,"data-fileindex":"-1"}),r.$preview.find("#zoom-"+n).attr("id","zoom-"+e)))}),r.filestack=l,r.filenames=s,r.fileids=d},_isFileSelectionValid:function(e){var i=this;return e=e||0,i.required&&!i.getFilesCount()?(i.$errorContainer.html(""),i._showUploadError(i.msgFileRequired),!1):!(0<i.minFileCount&&i._getFileCount(e)<i.minFileCount)||(i._noFilesError({}),!1)},clearStack:function(){return this.filestack=[],this.filenames=[],this.fileids=[],this.$element},updateStack:function(e,i){var t=this;return t.filestack[e]=i,t.filenames[e]=t._getFileName(i),t.fileids[e]=i&&t._getFileId(i)||null,t.$element},addToStack:function(e){var i=this;return i.filestack.push(e),i.filenames.push(i._getFileName(e)),i.fileids.push(i._getFileId(e)),i.$element},getFileStack:function(i){return this.filestack.filter(function(e){return i?void 0!==e:null!=e})},getFilesCount:function(){var e=this.isUploadable?this.getFileStack().length:this.$element.get(0).files.length;return this._getFileCount(e)},lock:function(){var e=this;return e._resetErrors(),e.disable(),e.showRemove&&Z.addCss(e.$container.find(".fileinput-remove"),"hide"),e.showCancel&&e.$container.find(".fileinput-cancel").removeClass("hide"),e._raise("filelock",[e.filestack,e._getExtraData()]),e.$element},unlock:function(e){var i=this;return void 0===e&&(e=!0),i.enable(),i.showCancel&&Z.addCss(i.$container.find(".fileinput-cancel"),"hide"),i.showRemove&&i.$container.find(".fileinput-remove").removeClass("hide"),e&&i._resetFileStack(),i._raise("fileunlock",[i.filestack,i._getExtraData()]),i.$element},cancel:function(){var e,t=this,i=t.ajaxRequests,a=i.length;if(0<a)for(e=0;e<a;e+=1)t.cancelling=!0,i[e].abort();return t._setProgressCancelled(),t._getThumbs().each(function(){var e=O(this),i=e.attr("data-fileindex");e.removeClass("file-uploading"),void 0!==t.filestack[i]&&(e.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),e.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),t.unlock()}),t.$element},clear:function(){var e,i=this;if(i._raise("fileclear"))return i.$btnUpload.removeAttr("disabled"),i._getThumbs().find("video,audio,img").each(function(){Z.cleanMemory(O(this))}),i._resetUpload(),i.clearStack(),i._clearFileInput(),i._resetErrors(!0),i._hasInitialPreview()?(i._showFileIcon(),i._resetPreview(),i._initPreviewActions(),i.$container.removeClass("file-input-new")):(i._getThumbs().each(function(){i._clearObjects(O(this))}),i.isUploadable&&(i.previewCache.data={}),i.$preview.html(""),e=!i.overwriteInitial&&0<i.initialCaption.length?i.initialCaption:"",i.$caption.html(e),i.$caption.attr("title",""),Z.addCss(i.$container,"file-input-new"),i._validateDefaultPreview()),0===i.$container.find(Z.FRAMES).length&&(i._initCaption()||i.$captionContainer.find(".kv-caption-icon").hide()),i._hideFileIcon(),i._raise("filecleared"),i.$captionContainer.focus(),i._setFileDropZoneTitle(),i.$element},reset:function(){var e=this;if(e._raise("filereset"))return e._resetPreview(),e.$container.find(".fileinput-filename").text(""),Z.addCss(e.$container,"file-input-new"),(e.$preview.find(Z.FRAMES).length||e.isUploadable&&e.dropZoneEnabled)&&e.$container.removeClass("file-input-new"),e._setFileDropZoneTitle(),e.clearStack(),e.formdata={},e.$element},disable:function(){var e=this;return e.isDisabled=!0,e._raise("filedisabled"),e.$element.attr("disabled","disabled"),e.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),e.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),e._initDragDrop(),e.$element},enable:function(){var e=this;return e.isDisabled=!1,e._raise("fileenabled"),e.$element.removeAttr("disabled"),e.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),e.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),e._initDragDrop(),e.$element},upload:function(){var e,i,t,a=this,n=a.getFileStack().length,r=!O.isEmptyObject(a._getExtraData());if(a.isUploadable&&!a.isDisabled&&a._isFileSelectionValid(n))if(a._resetUpload(),0!==n||r)if(a.$progress.removeClass("hide"),a.uploadCount=0,a.uploadStatus={},a.uploadLog=[],a.lock(),a._setProgress(2),0===n&&r)a._uploadExtraOnly();else{if(t=a.filestack.length,a.hasInitData=!1,!a.uploadAsync)return a._uploadBatch(),a.$element;for(i=a._getOutData(),a._raise("filebatchpreupload",[i]),a.fileBatchCompleted=!1,a.uploadCache={content:[],config:[],tags:[],append:!0},a.uploadAsyncCount=a.getFileStack().length,e=0;e<t;e++)a.uploadCache.content[e]=null,a.uploadCache.config[e]=null,a.uploadCache.tags[e]=null;for(a.$preview.find(".file-preview-initial").removeClass(Z.SORT_CSS),a._initSortable(),a.cacheInitialPreview=a.getPreview(),e=0;e<t;e++)void 0!==a.filestack[e]&&a._uploadSingle(e,a.filestack,!0)}else a._showUploadError(a.msgUploadEmpty)},destroy:function(){var e=this,i=e.$form,t=e.$container,a=e.$element,n=e.namespace;return O(document).off(n),O(window).off(n),i&&i.length&&i.off(n),e.isUploadable&&e._clearFileInput(),e._cleanup(),e._initPreviewCache(),a.insertBefore(t).off(n).removeData(),t.off().remove(),a},refresh:function(e){var i=this,t=i.$element;return e=e?O.extend(!0,{},i.options,e):i.options,i.destroy(),t.fileinput(e),(i=t.data("fileinput")).isUploadable&&i._clearFileInput(),t.val()&&t.trigger("change.fileinput"),t},zoom:function(e){var i=this,t=O("#"+e),a=i.$modal;t.length?(Z.initModal(a),a.html(i._getModalContent()),i._setZoomContent(t),a.modal("show"),i._initZoomButtons()):i._log('Cannot zoom to detailed preview! Invalid frame with id: "'+e+'".')},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},O.fn.fileinput=function(s){if(Z.hasFileAPISupport()||Z.isIE(9)){var d=Array.apply(null,arguments),c=[];switch(d.shift(),this.each(function(){var e,i=O(this),t=i.data("fileinput"),a="object"==typeof s&&s,n=a.theme||i.data("theme"),r={},o={},l=a.language||i.data("language")||O.fn.fileinput.defaults.language||"en";t||(n&&(o=O.fn.fileinputThemes[n]||{}),"en"===l||Z.isEmpty(O.fn.fileinputLocales[l])||(r=O.fn.fileinputLocales[l]||{}),e=O.extend(!0,{},O.fn.fileinput.defaults,o,O.fn.fileinputLocales.en,r,a,i.data()),t=new p(this,e),i.data("fileinput",t)),"string"==typeof s&&c.push(t[s].apply(t,d))}),c.length){case 0:return this;case 1:return c[0];default:return c}}},O.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!0,required:!1,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-default btn-header-toggle",fullscreen:"btn btn-default",borderless:"btn btn-default",close:"btn btn-default"},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-success progress-bar-striped active",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",progressErrorClass:"progress-bar progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:'<span class="close kv-error-close">&times;</span>',slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0},O.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},O.fn.fileinput.Constructor=p,O(document).ready(function(){var e=O("input.file[type=file]");e.length&&e.fileinput()})});